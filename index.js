/**
 * week-identifier <https://github.com/throll/week-identifier>
 *
 * Copyright (c) 2016 ClÃ©ment Billiot, contributors.
 * Released under the MIT license.
 */

'use strict';

module.exports = weekIdentifier;
module.exports.weekIdentifier = weekIdentifier;
//module.exports.rec709 = rec709;

/**
 * Get unique and sequential week identifier of current date or given valid `Date` string format
 *
 * **Example:**
 *
 * ```js
 * var weekIdentifier = require('current-week-number');
 *
 * // august 12, 2016 (current date)
 * weekIdentifier();
 * //=> 2432
 *
 * weekIdentifier('January 05, 1970 03:00:00');
 * //=> 1
 *
 * weekIdentifier(new Date('August 12, 2016'));
 * //=> 2432
 *
 * weekIdentifier('08/12/2016');
 * //=> 2432
 *
 * weekIdentifier('August 12, 2016');
 * //=> 2432
 *
 * weekIdentifier(new Date('August 19, 2016'));
 * //=> 2433
 *
 * weekIdentifier('08/19/2016');
 * //=>  2433
 * ```
 *
 * @name weekIdentifier
 * @param  {String} `[date]` every valid Date-ish string format
 * @return {Number}
 * @api public
 */
function weekIdentifier(date) {
  var instance;

  if (typeof date === 'string' && date.length) {
    instance = new Date(date);
  } else if (date instanceof Date) {
    instance = date;
  } else {
    instance = new Date();
  }

  // Create a copy of this date object
  var target = new Date(instance.valueOf());
  // Starting date point for our sequence
  var firstDayOfWeekOne = new Date('January 4, 1970 23:59:59.999');
  // Number of week from our starting date
  var weekNumberdiff = Math.ceil((target.getTime() - firstDayOfWeekOne.getTime()) / (24 * 3600 * 1000 * 7));

  return weekNumberdiff;
}

//TODO
//function dateFromWeek(weekIdentifier) {}
